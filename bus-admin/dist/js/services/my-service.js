angular.module("app.service",[]).service("$myHttpService",function($http){this.post=function(url,data,success,error){var loadIndex=layer.msg("请求资源中……",{time:99999999,offset:"100px"});$http.post(url,data).success(function(data){layer.close(loadIndex),0==data.code?success(data.data):(layer?layer.alert(JSON.stringify(data)):alert(JSON.stringify(data)),error&&error(data.data))}).error(function(e){layer.close(loadIndex),layer?layer.alert(e.message):alert(e.message),error&&error(e)})},this.get=function(url,data,success,error){var loadIndex=layer.msg("请求资源中……",{time:99999999,offset:"100px"});$http.get(url,data).success(function(data){layer.close(loadIndex),0==data.code?success(data.data):(layer?layer.alert(JSON.stringify(data)):alert(JSON.stringify(data)),error&&error(data.data))}).error(function(e){layer.close(loadIndex),layer?layer.alert(e.message):alert(e.message),error&&error(e)})}}).service("$tableListService",function($myHttpService,$localStorage){var $scopeLocal={},pageSizeList=[{text:"5",value:"5"},{text:"10",value:"10"},{text:"20",value:"20"}],defaultOptions={beforeSend:function(){},callback:function(){},error:function(){},pageSize:pageSizeList[0].value,searchFormId:"searchForm",formData:{}};this.init=function($scope,option){var options=$.extend({},defaultOptions,option);$scopeLocal=$scope,$scopeLocal.pageSizeList=pageSizeList,$scopeLocal.pageRequest={pageNum:1,pageSize:options.pageSize},angular.isDefined($localStorage.pageSize)?$scopeLocal.pageRequest.pageSize=$localStorage.pageSize:$localStorage.pageSize=$scopeLocal.pageRequest.pageSize,$scopeLocal.pageRequest.getResponse=function(){$scopeLocal.pageRequest.pageSize!=$localStorage.pageSize&&($localStorage.pageSize=$scopeLocal.pageRequest.pageSize);var requestData=$("#"+options.searchFormId).serialize(),offset=($scopeLocal.pageRequest.pageNum-1)*$scopeLocal.pageRequest.pageSize,url=options.listUrl+"?"+requestData+"&offset="+offset+"&pagesize="+$scopeLocal.pageRequest.pageSize;angular.isDefined($scopeLocal.pageRequest.orderBy)&&""!=$scopeLocal.pageRequest.orderBy&&(url+="&orderby="+$scopeLocal.pageRequest.orderBy),$myHttpService.post(url,options.formData,function(data){$scopeLocal.pageResponse=data,options.callback($scopeLocal,data)})},this.get=function(){$scopeLocal.pageRequest.getResponse()}}});