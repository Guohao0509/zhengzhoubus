app.controller("Charterbus",function($scope,$myHttpService,$modal,$tableListService,$state){var selected=!1;$scope.selectAll=function(){selected=!selected,angular.forEach($scope.pageResponse.rows,function(item){item.selected=selected})},$scope.deleteRow=function(){for(var i=0;i<$scope.pageResponse.rows.length;i++){if($scope.pageResponse.rows[i].selected)return $scope.deletechartid={charterid:$scope.pageResponse.rows[i].charterid},console.log($scope.deletechartid.charterid),layer.confirm("您确定要删除选中的信息吗？",{icon:3,title:"提示"},function(){$myHttpService.post("api/charterOrder/deleteCharterCase",{charterid:$scope.deletechartid.charterid},function(){layer.msg("删除成功！",{offset:"100px"}),$state.go("app.charterbus.operationadmin",{},{reload:!0})})},function(index){layer.close(index)}),!1;layer.msg("请选择删除的信息")}},$scope.caseStatusname=["1","2","3","4","5","6","0"],$scope.selectname={1:"待审核",2:"审核失败",3:"未支付",4:"支付失败",5:"已支付",6:"已完成",0:"全部状态"};var options={searchFormId:"J_charter_form",listUrl:"api/charterOrder/queryChartersByAllKeyword"};$tableListService.init($scope,options),$tableListService.get(),$scope.queryneedinfo={"true":"是","false":"否"},$scope.charterStart={opened:!1,dateOptions:{datepickerMode:"day",showWeeks:!1,minMode:"day"},format:"yyyy-MM-dd",clear:function(){$scope.charterStartTime=null},disabled:function(date,mode){return"day"===mode&&(0===date.getDay()||6===date.getDay())},toggleMin:function(){$scope.minDate=$scope.minDate?null:new Date},open:function($event){$event.preventDefault(),$event.stopPropagation(),$scope.charterStart.opened=!0}},$scope.charterEnd={opened:!1,dateOptions:{datepickerMode:"day",showWeeks:!1,minMode:"day"},format:"yyyy-MM-dd",clear:function(){$scope.charterEndTime=null},disabled:function(date,mode){return"day"===mode&&(0===date.getDay()||6===date.getDay())},toggleMin:function(){$scope.minDate=$scope.minDate?null:new Date},open:function($event){$event.preventDefault(),$event.stopPropagation(),$scope.charterEnd.opened=!0}},$scope.charterlist={offset:0,pagesize:10},$scope.charterdetail=function(charterid){$modal.open({templateUrl:"a-bugubus/charterbus/charter_detail.html",controller:"charterdetail",size:"md",resolve:{charterid:function(){return charterid}}}),console.log("charterid:"+charterid)}}),app.controller("charterdetail",["$scope","$modalInstance","charterid","$myHttpService",function($scope,$chartermodel,charterid,$myHttpService){$myHttpService.post("api/charterOrder/CharterCaseDetails",{charterid:charterid},function(data){$scope.data=data,console.log("data"+$scope.data)}),$scope.userdetailneedinfo={"true":"是","false":"否"},$scope.ok=function(){$chartermodel.close()}}]),app.controller("charterbusEditController",function($scope,$myHttpService,$stateParams,$filter,$state){$scope.editMode=!!$stateParams.charterid,$scope.editMode&&($scope.charter={charterid:$stateParams.charterid},$myHttpService.post("api/charterOrder/CharterCaseDetails",$scope.charter,function(data){$scope.charters=data,$scope.charterinfo={"true":"是","false":"否"},$scope.chartertime={charterStartTime:$filter("date")($scope.charters.charterStartTime,"yyyy-MM-dd HH:mm"),charterEndTime:$filter("date")($scope.charters.charterEndTime,"yyyy-MM-dd HH:mm")},console.log("关于编辑:"+JSON.stringify($scope.charters))})),$scope.submit=function(){$scope.editmess={charterid:$scope.charters.charterid,startLocation:$scope.charters.startLocation,startLoLa:$scope.charters.startLoLa,endLocation:$scope.charters.endLocation,endLoLa:$scope.charters.endLoLa,charterType:$scope.charters.charterType,charterStartTime:$filter("date")($scope.charters.charterStartTime,"yyyy-MM-dd HH:mm"),charterEndTime:$filter("date")($scope.charters.charterEndTime,"yyyy-MM-dd HH:mm"),charterCount:$scope.charters.charterCount,needInfo:$scope.charters.needInfo,caseStatus:$scope.charters.caseStatus,totalfee:$scope.charters.totalfee,commName:$scope.charters.commName,commMobile:$scope.charters.commMobile,repInfo:$scope.charters.repInfo},$myHttpService.post("api/charterOrder/ModifyCharterCase",$scope.editmess,function(){layer.msg("修改成功！",{offset:"100px"})})},$scope.delete=function(charters){layer.confirm("您确定要删除吗？",{icon:3,title:"提示"},function(){$myHttpService.post("api/charterOrder/deleteCharterCase",{charterid:charters.charterid},function(){layer.msg("删除成功！",{offset:"100px"}),$state.go("app.charterbus.operationadmin",{},{reload:!0})})},function(index){layer.close(index)})}});