app.run(function($rootScope,$state,$stateParams,$localStorage,$http,$myHttpService){$http.defaults.headers.common.Authorization="Basic "+$localStorage.auth,$rootScope.$state=$state,$rootScope.$stateParams=$stateParams,$rootScope.$on("$stateChangeSuccess",function(event,to,toParams,from,fromParams){$rootScope.previousState=from,$rootScope.previousStateParams=fromParams}),$rootScope.$on("$stateChangeStart",function(event,toState){var urls=toState.name.split(".");urls.length>0&&"auth"!=urls[0]&&void 0==$rootScope.session_user&&$myHttpService.get("auth/check",{},function(data){null==data?$state.go("auth.login"):$rootScope.session_user=data})}),$rootScope.logout=function(){$myHttpService.get("auth/logout",{},function(){$rootScope.session_user=void 0,$state.go("auth.login")})}}).config(function($stateProvider,$urlRouterProvider){var basePath="a-bugubus/";$urlRouterProvider.otherwise("/app/dashboard"),$stateProvider.state("error",{"abstract":!0,url:"/error",template:'<div ui-view class="fade-in"></div>'}).state("error.404",{url:"/404",templateUrl:basePath+"error/404.html"}).state("auth",{"abstract":!0,url:"/auth",template:'<div ui-view class="fade-in"></div>',resolve:{deps:["$ocLazyLoad",function($ocLazyLoad){return $ocLazyLoad.load("a-bugubus/auth/controller.js")}]}}).state("auth.loading",{url:"/loading",templateUrl:basePath+"auth/loading.html"}).state("auth.login",{url:"/login",templateUrl:basePath+"auth/login.html"}).state("app",{"abstract":!0,url:"/app",templateUrl:basePath+"app.html"}).state("app.dashboard",{url:"/dashboard",templateUrl:basePath+"dashboard.html",ncyBreadcrumb:{label:'<i class="fa fa-home"></i> 首页'}}).state("app.driver",{"abstract":!0,url:"/driver",template:'<div ui-view class="fade-in"></div>',resolve:{deps:["$ocLazyLoad",function($ocLazyLoad){return $ocLazyLoad.load("a-bugubus/driver/controller.js")}]}}).state("app.driver.list",{url:"/list",templateUrl:basePath+"driver/list.html",ncyBreadcrumb:{parent:"app.dashboard",label:"司机列表"}}).state("app.driver.add",{url:"/add",templateUrl:basePath+"driver/edit.html",ncyBreadcrumb:{parent:"app.driver.list",label:"添加司机"}}).state("app.driver.edit",{url:"/edit/{id}",templateUrl:basePath+"driver/edit.html",ncyBreadcrumb:{parent:"app.driver.list",label:"编辑司机"}}).state("app.driver.detail",{url:"/detail/{id}",templateUrl:basePath+"driver/detail.html",ncyBreadcrumb:{parent:"app.driver.list",label:"司机详情"}}).state("app.route",{"abstract":!0,url:"/route",template:'<div ui-view class="fade-in"></div>',resolve:{deps:["$ocLazyLoad",function($ocLazyLoad){return $ocLazyLoad.load(basePath+"route/controller.js")}]}}).state("app.route.list",{url:"/list",templateUrl:basePath+"route/list.html",ncyBreadcrumb:{parent:"app.dashboard",label:"线路列表"}}).state("app.route.create_list",{url:"/create_list",templateUrl:basePath+"route/create_list.html",ncyBreadcrumb:{parent:"app.dashboard",label:"线路报名"}}).state("layout",{"abstract":!0,url:"/layout",templateUrl:basePath+"a-blocks/layout.html",resolve:{deps:["uiLoad",function(uiLoad){return uiLoad.load([basePath+"route/controller.js","http://webapi.amap.com/maps?v=1.3&key=1a5cdec55ebac9dbd85652429f54d4d1&callback=init","vendor/jquery/sortable/jquery.sortable.js"])}]}}).state("layout.route_add",{url:"/route_add",views:{"":{templateUrl:basePath+"route/edit.html"},footer:{templateUrl:basePath+"a-blocks/layout_footer_fullwidth.html"}}}).state("layout.route_edit",{url:"/route_edit/{id}",views:{"":{templateUrl:basePath+"route/edit.html"},footer:{templateUrl:basePath+"a-blocks/layout_footer_fullwidth.html"}}}).state("app.schedule",{"abstract":!0,url:"/schedule",template:'<div ui-view class="fade-in"></div>',resolve:{deps:["$ocLazyLoad",function($ocLazyLoad){return $ocLazyLoad.load(basePath+"schedule/controller.js")}]}}).state("app.schedule.list",{url:"/list",templateUrl:basePath+"schedule/list.html",ncyBreadcrumb:{parent:"app.dashboard",label:"排班列表"}}).state("app.schedule.add",{url:"/add",templateUrl:basePath+"schedule/edit.html",ncyBreadcrumb:{parent:"app.schedule.list",label:"添加排班"}}).state("app.schedule.edit",{url:"/edit/{id}",templateUrl:basePath+"schedule/edit.html",ncyBreadcrumb:{parent:"app.schedule.list",label:"编辑排班"}}).state("app.bus",{"abstract":!0,url:"/bus",template:'<div ui-view class="fade-in"></div>',resolve:{deps:["$ocLazyLoad",function($ocLazyLoad){return $ocLazyLoad.load(basePath+"bus/controller.js")}]}}).state("app.bus.list",{url:"/list",templateUrl:basePath+"bus/list.html",ncyBreadcrumb:{parent:"app.dashboard",label:"车辆列表"}}).state("app.bus.add",{url:"/add",templateUrl:basePath+"bus/edit.html",ncyBreadcrumb:{parent:"app.bus.list",label:"添加车辆"}}).state("app.bus.edit",{url:"/edit/{id}",templateUrl:basePath+"bus/edit.html",ncyBreadcrumb:{parent:"app.bus.list",label:"编辑车辆"}}).state("app.bus.historical",{url:"/historical",templateUrl:basePath+"bus/historical.html",ncyBreadcrumb:{parent:"",label:"轨迹回放"}}).state("app.trade",{"abstract":!0,url:"/trade",template:'<div ui-view class="fade-in"></div>',resolve:{deps:["$ocLazyLoad",function($ocLazyLoad){return $ocLazyLoad.load(basePath+"trade/controller.js")}]}}).state("app.trade.ticket_list",{url:"/ticket_list",templateUrl:basePath+"trade/ticket_list.html",ncyBreadcrumb:{parent:"app.dashboard",label:"车票列表"}}).state("app.trade.recharge_list",{url:"/recharge_list",templateUrl:basePath+"trade/recharge_list.html",ncyBreadcrumb:{parent:"app.dashboard",label:"充值列表"}}).state("app.user",{"abstract":!0,url:"/user",template:'<div ui-view class="fade-in"></div>',resolve:{deps:["$ocLazyLoad",function($ocLazyLoad){return $ocLazyLoad.load(basePath+"user/controller.js")}]}}).state("app.statistic",{"abstract":!0,url:"/statistic",template:'<div ui-view class="fade-in"></div>',resolve:{deps:["$ocLazyLoad",function($ocLazyLoad){return $ocLazyLoad.load(basePath+"statistic/controller.js")}]}}).state("app.statistic.profit",{url:"/profit",templateUrl:basePath+"statistic/profit.html",ncyBreadcrumb:{parent:"app.dashboard",label:"收益统计"}}).state("app.user.user_list",{url:"/user_list",templateUrl:basePath+"user/user_list.html",ncyBreadcrumb:{parent:"app.dashboard",label:"用户管理"}}).state("app.charterbus",{"abstract":!0,url:"/charterbus",template:'<div ui-view class="fade-in"></div>',resolve:{deps:["$ocLazyLoad",function($ocLazyLoad){return $ocLazyLoad.load(basePath+"charterbus/controller.js")}]}}).state("app.charterbus.operationadmin",{url:"/operationadmin",templateUrl:basePath+"charterbus/operationadmin.html",ncyBreadcrumb:{parent:"app.charterbus",label:"包车管理"}}).state("app.charterbus.edit",{url:"/edit/{charterid}",templateUrl:basePath+"charterbus/edit.html",ncyBreadcrumb:{parent:"app.charterbus.operationadmin",label:"包车服务"}}).state("app.refound",{"abstract":!0,url:"/refound",template:'<div ui-view class="fade-in"></div>',resolve:{deps:["$ocLazyLoad",function($ocLazyLoad){return $ocLazyLoad.load(basePath+"refound/controller.js")}]}}).state("app.refound.list",{url:"/list",templateUrl:basePath+"refound/list.html",ncyBreadcrumb:{parent:"app.dashboard",label:"退款记录列表"}})});